### 智能太空舱管理系统 概要设计说明书

#### 1. 概述
本系统旨在为太空舱提供实时监测和自动化管理的功能，确保舱内环境维持在适宜人类生存的条件。系统采用嵌入式设计技术，以多功能控制模块为核心设备，结合多种传感器实时采集舱内的空气成分、温度、湿度、气压等关键环境参数。通过前端界面进行数据可视化与远程控制，用户可以在自动和手动模式间切换，灵活管理太空舱的环境。本系统智能化程度高、操作简便，能够有效降低操作负担，提高环境维持效率。

#### 2. 系统功能
1. **数据监测与控制**：
   - 使用DHT11温湿度传感器、BMP180气压传感器等传感器采集环境数据（温度、湿度、气压），并传输至服务器和数据库。
   - 支持自动控制模式，根据预设阈值自动启停气阀、除湿器和加热器。
   - 支持手动控制模式，用户可通过前端界面手动控制各设备。

2. **警报功能**：
   - 系统实时监测环境数据，当检测到数据超出安全阈值时，警报灯自动点亮，以提醒用户异常情况。

3. **数据存储与查询**：
   - 系统自动存储环境数据和设备状态数据，用户可以按时间查询历史数据。前端展示最近一小时、一天及两天的环境变化趋势，并通过折线图、柱状图等方式可视化数据。

4. **用户身份验证**：
   - 系统提供登录验证功能，确保数据安全性。未登录用户无法访问系统的控制与数据监测功能。

#### 3. 系统架构设计
系统主要分为数据监测模块、数据传输模块、控制模块、警报模块、数据库模块、服务器模块和前端模块。

1. **数据监测模块**：
   - 通过DHT11、BMP180和LDR等传感器采集温度、湿度、气压和光照强度。
   - 监测模块根据设定的时间间隔读取传感器数据并传输给服务器。

2. **数据传输模块**：
   - 数据传输模块包括硬件到服务器和服务器到硬件的双向数据传输。
   - 硬件到数据库的数据传输主要通过串口通信，将数据上传到服务器并存储在数据库中。
   - 服务器到硬件的传输用于接收前端用户的控制指令，并传递给硬件以执行相应的动作。

3. **控制模块**：
   - **自动控制模式**：系统根据传感器的数据自动判断并控制设备的启停。例如，温度超过预设值时，自动开启风机。
   - **手动控制模式**：用户可通过前端界面切换到手动模式，并发送控制指令，直接操作硬件设备的状态。

4. **警报模块**：
   - 通过警报灯模块，在检测到温度、湿度、气压或光照超出预设范围时，自动触发警报灯，以提示异常情况。

5. **数据库模块**：
   - 使用MySQL数据库存储环境数据和设备状态数据，支持数据的创建、更新、查询等操作。
   - 数据表设计：包括环境数据表和设备数据表，分别记录环境参数和设备的运行状态。
   - 支持按时间戳查询数据，提供指定时间段的历史数据供用户参考。

6. **服务器模块**：
   - 基于Flask框架，负责前端和硬件之间的通信。
   - 服务器接收前端的请求，进行数据库查询或数据更新，并传递至硬件端。
   - 服务器还支持用户登录状态的session维护，确保用户访问安全性。

7. **前端模块**：
   - 前端页面使用HTML、CSS、JavaScript及jQuery构建，支持用户登录、数据可视化展示、实时数据更新、手动设备控制等功能。
   - 前端具有自动刷新功能，页面每隔一定时间自动向服务器请求数据，以实现动态显示最新数据。

#### 4. 系统技术选型与工具
- **硬件与传感器**：
  - **主控芯片**：Arduino UNO
  - **传感器**：DHT11温湿度传感器、BMP180气压传感器\
  - **其他设备**：气阀、除湿器、加热器等

- **开发平台与语言**：
  - **嵌入式开发**：Proteus 8.6用于仿真设计，FreeRTOS用于实时操作系统调度
  - **后端**：Flask框架（Python 3.8），pymysql库用于数据库操作
  - **前端**：HTML、CSS、JavaScript、jQuery和echarts.js用于数据可视化展示

- **数据库**：
  - 使用MySQL 8.0.15，提供数据存储、查询功能，并保证数据的持久化。

#### 5. 系统流程设计
1. **数据采集与存储**：
   - 硬件端周期性地从各传感器采集数据，数据按预设格式通过串口传输到服务器，服务器将数据解析并存入MySQL数据库。
   - 数据采集流程图如下：
     ```css
     [开始] → [传感器采集数据] → [格式化数据] → [通过串口传输] → [服务器解析并存储]
     ```

2. **自动与手动控制**：
   
   - 系统初始为自动模式，根据设定的阈值自动控制设备启停。用户可通过前端切换至手动模式，并发送控制指令，手动操作设备。
   - 控制流程图如下：
     ```css
     [自动模式] → [检查传感器数据] → [判断是否超出阈值] → [控制设备状态]
     [手动模式] → [接收前端指令] → [控制设备状态]
     ```
   
3. 自动与手动控制：

   - 前端页面请求服务器获取不同时间段的数据，数据通过echarts.js渲染成折线图或柱状图，动态展示环境变化情况。

   - 数据查询流程图如下：

     ```css
      [用户请求数据] → [服务器查询数据库] → [返回查询数据] → [前端渲染图表]
     ```

#### 6. 总结
太空舱环境管理系统旨在为宇航员提供一个安全、可控的生存环境。通过先进的环境监测技术，系统能够实时采集舱内的温度、湿度、气压等关键数据，并根据这些数据在自动模式下进行智能调控，确保环境稳定。系统还配备了手动模式和警报功能，以便用户在必要时进行精确控制和及时响应异常状况。所有环境数据和操作记录均会被存储，用户可以在安全的前端界面上实时查看和管理数据。通过综合的架构设计，太空舱环境管理系统能够显著提高舱内环境维持效率，保障宇航员的健康和安全。